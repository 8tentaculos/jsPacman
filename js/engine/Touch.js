import View from"rasti/View.js";export const EVENT_SWIPE="swipe";export const EVENT_DOUBLE_TAP="doubletap";export const EVENT_SWIPE_UP="swipe:up";export const EVENT_SWIPE_RIGHT="swipe:right";export const EVENT_SWIPE_DOWN="swipe:down";export const EVENT_SWIPE_LEFT="swipe:left";const defaults={threshold:100,restraint:150,allowedTime:400,doubleTapDelay:300,doubleTapThreshold:50};class Touch extends View{constructor(t={}){super({...t,el:t.el||document&&document.body}),Object.keys(defaults).forEach(s=>{s in t&&(this[s]=t[s])}),this.onTouchStart=this.onTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this._lastTapTime=0,this._lastTapX=0,this._lastTapY=0,this.el.addEventListener("touchstart",this.onTouchStart,!1),this.el.addEventListener("touchend",this.onTouchEnd,!1)}onDestroy(){this.el.removeEventListener("touchstart",this.onTouchStart),this.el.removeEventListener("touchend",this.onTouchEnd)}onTouchStart(t){const s=t.changedTouches[0];this.startX=s.pageX,this.startY=s.pageY,this.startTime=new Date;const e=Date.now(),h=e-this._lastTapTime,a=s.pageX,i=s.pageY,o=Math.abs(a-this._lastTapX),n=Math.abs(i-this._lastTapY);h<this.doubleTapDelay&&o<this.doubleTapThreshold&&n<this.doubleTapThreshold?(this.emit("doubletap",t),this._lastTapTime=0):(this._lastTapTime=e,this._lastTapX=a,this._lastTapY=i)}onTouchEnd(t){let s=null;const e=t.changedTouches[0],h=e.pageX-this.startX,a=e.pageY-this.startY;new Date-this.startTime<=this.allowedTime&&(Math.abs(h)>=this.threshold&&Math.abs(a)<=this.restraint?s=h<0?"swipe:left":"swipe:right":Math.abs(a)>=this.threshold&&Math.abs(h)<=this.restraint&&(s=a<0?"swipe:up":"swipe:down"),this.emit("swipe",s,t))}}Object.assign(Touch.prototype,defaults);export default Touch;